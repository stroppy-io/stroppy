syntax = "proto3";

package stroppy;

import "google/protobuf/empty.proto";
import "stroppy/runtime.proto";
import "stroppy/config.proto";

option go_package = "github.com/stroppy-io/stroppy/pkg/common/proto";

/**
 * SidecarPlugin defines the gRPC service that sidecar plugins must implement.
 */
service SidecarService {
    /**
     * Initialize is called once before the benchmark starts.
     * Used to initialize resources of SidecarPlugin.
     */
    rpc Initialize (GlobalConfig) returns (google.protobuf.Empty);
    /**
     * OnStepStart is called once before each step starts.
     */
    rpc OnStepStart (StepContext) returns (google.protobuf.Empty);
    /**
     * OnStepEnd is called once after each step ends.
     */
    rpc OnStepEnd (StepContext) returns (google.protobuf.Empty);
    /**
     * Teardown is called once after the benchmark ends.
     * Used to clean up resources.
     */
    rpc Teardown (GlobalConfig) returns (google.protobuf.Empty);
}
